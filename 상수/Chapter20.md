# 20장 리버스 프록시를 이용해 컨테이너 HTTP 트래픽 제어하기

---

## 객관식 문제 (4지선다형)

### 1. 리버스 프록시의 핵심 역할로 가장 적절한 것은?
A. 클라이언트가 직접 컨테이너 포트로 접근하도록 포트를 공개한다  
B. 여러 웹 애플리케이션으로 가는 관문(gateway) 역할을 수행한다  
C. 컨테이너 이미지를 자동 빌드한다  
D. DB 쿼리를 캐싱한다  

---

### 2. “리버스 프록시만 외부 포트를 공개한다”의 장점으로 가장 적절한 것은?
A. 모든 컨테이너가 80/443 포트를 공유할 수 있다  
B. 애플리케이션 컨테이너 포트를 외부에 노출하지 않아도 되어 보안·배포에 유리하다  
C. 컨테이너 로그가 자동으로 중앙 수집된다  
D. 도커 엔진이 필요 없어도 된다  

---

### 3. Nginx 설정에서 `proxy_pass http://whoami;`의 의미로 옳은 것은?
A. 클라이언트 요청을 whoami 업스트림으로 전달한다  
B. whoami 컨테이너의 로그를 프록시로 전달한다  
C. whoami 컨테이너를 자동으로 스케일링한다  
D. SSL 인증서를 whoami 컨테이너에 적용한다  

---

### 4. Nginx 응답 헤더 중 실제 요청을 처리한 업스트림 컨테이너의 IP를 나타내는 것은?
A. X-Proxy  
B. X-Host  
C. X-Upstream  
D. Strict-Transport-Security  

---

### 5. 리버스 프록시에서 HTTPS를 적용할 때 올바른 설명은?
A. 모든 업스트림 컨테이너가 443 포트를 외부에 노출해야 한다  
B. 인증서와 키는 민감 정보이므로 비밀값(secrets) 형태로 관리하는 것이 적절하다  
C. 인증서는 하나로 모든 도메인에서 공용 사용 가능하다  
D. HTTPS는 애플리케이션 컨테이너에서만 적용 가능하다  

---

### 6. Nginx에서 80번 포트를 443으로 리다이렉트하는 이유는?
A. 로드 밸런싱을 비활성화하기 위해  
B. HTTP 접근을 HTTPS로 강제하기 위해  
C. DNS 조회를 생략하기 위해  
D. 캐시를 항상 사용하기 위해  

---

### 7. 캐싱 프록시(Nginx proxy_cache)의 가장 큰 장점은?
A. 업스트림 컨테이너 장애를 완전히 제거한다  
B. 동일 요청에 대해 업스트림 호출을 줄여 성능과 처리량을 개선한다  
C. 데이터베이스 트랜잭션을 자동 최적화한다  
D. 로그 저장 공간을 줄인다  

---

### 8. 응답에 `X-Cache: HIT` 이고 `X-Upstream` 헤더가 없는 경우의 의미는?
A. 업스트림 컨테이너가 비정상 상태다  
B. 프록시 캐시에서 바로 응답이 반환되었다  
C. HTTPS 설정이 잘못되었다  
D. 로드 밸런싱이 실패했다  

---

### 9. Traefik(트래픽)의 특징으로 옳은 것은?
A. 컨테이너 레이블을 통해 동적으로 라우팅 설정을 구성한다  
B. Nginx와 동일한 캐싱 프록시 기능을 기본 제공한다  
C. 런타임 중 설정 변경이 불가능하다  
D. Docker API를 사용하지 않는다  

---

### 10. 스티키 세션(Sticky Session)이 필요한 상황으로 가장 적절한 것은?
A. 애플리케이션이 완전 무상태(stateless)인 경우  
B. 사용자 상태가 있어 같은 사용자의 요청이 항상 같은 컨테이너로 가야 하는 경우  
C. HTTPS 인증서를 자동 발급하고 싶은 경우  
D. 캐시 만료 시간을 늘리고 싶은 경우  

---

## 정답 및 해설

| 문제 | 정답 | 해설 |
|----|----|----|
| 1 | B | 리버스 프록시는 여러 애플리케이션으로 향하는 관문 역할 |
| 2 | B | 프록시만 외부 노출 → 보안·배포·스케일링 유리 |
| 3 | A | `proxy_pass`는 업스트림 컨테이너로 요청 전달 |
| 4 | C | X-Upstream 헤더에 실제 응답 컨테이너 IP 표시 |
| 5 | B | 인증서/키는 민감 정보 → secrets 관리 권장 |
| 6 | B | HTTP 요청을 HTTPS로 강제 리다이렉트 |
| 7 | B | 캐시 사용으로 응답 속도↑, 업스트림 부하↓ |
| 8 | B | 캐시 HIT → 업스트림 요청 없이 응답 |
| 9 | A | Traefik은 Docker API + 레이블 기반 동적 설정 |
| 10 | B | 상태 있는 앱은 스티키 세션 필요 |

---

## 요약 메모

- 리버스 프록시는 **외부 트래픽의 단일 진입점**
- **보안 / SSL / 라우팅 / 캐싱**을 애플리케이션과 분리
- Nginx: 강력한 캐싱 + 정적 설정
- Traefik: 클라우드 네이티브, 동적 설정, 자동 Service Discovery
- 운영 환경에서는 리버스 프록시가 사실상 필수 인프라
